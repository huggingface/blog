---
title: "NuminaMath æ˜¯å¦‚ä½•è£è†ºé¦–å±Š AIMO è¿›æ­¥å¥–çš„ï¼Ÿ"
thumbnail: /blog/assets/winning-aimo-progress-prize/thumbnail.png
authors:
  - user: yfleureau
    guest: true
    org: AI-MO
  - user: liyongsea
    guest: true
    org: AI-MO
  - user: edbeeching
  - user: lewtun
  - user: benlipkin
    guest: true
    org: AI-MO
  - user: romansoletskyi
    guest: true
    org: AI-MO
  - user: vwxyzjn
  - user: kashif
- translators:
  - user: MatrixYao
---

# NuminaMath æ˜¯å¦‚ä½•è£è†ºé¦–å±Š AIMO è¿›æ­¥å¥–çš„ï¼Ÿ

ä»Šå¹´ï¼Œ[**Numina**](https://projectnumina.ai) å’Œ Hugging Face åˆä½œè§’é€ [**AI æ•°å­¦å¥¥æ—åŒ¹å…‹ï¼ˆAI Math Olympiadï¼ŒAIMOï¼‰**](https://aimoprize.com) çš„é¦–å±Šè¿›æ­¥å¥–ã€‚æ­¤æ¬¡æ¯”èµ›æ—¨åœ¨å¯¹å¼€æ”¾ LLM è¿›è¡Œå¾®è°ƒï¼Œä»¥ä½¿å…¶èƒ½è§£å†³é«˜ä¸­éš¾åº¦çš„å›½é™…æ•°å­¦å¥¥æ—åŒ¹å…‹è®­ç»ƒé¢˜ã€‚æˆ‘ä»¬å¾ˆé«˜å…´å‘å¤§å®¶æŠ¥å‘Šï¼šæˆ‘ä»¬çš„æ¨¡å‹ - [**NuminaMath 7B TIR**](https://huggingface.co/AI-MO/NuminaMath-7B-TIR) - åœ¨æ¯”èµ›ä¸­è„±é¢–è€Œå‡ºï¼ŒæˆåŠŸè§£å†³äº†ç§æœ‰æµ‹è¯•é›† 50 é“é¢˜ä¸­çš„ 29 é“ğŸ¥³ï¼

![kaggle.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/kaggle.png)

æœ¬æ–‡ä»‹ç»äº† Numina è®¡åˆ’ä»¥åŠæˆ‘ä»¬è·èƒœæ–¹æ¡ˆèƒŒåçš„æŠ€æœ¯ç»†èŠ‚ã€‚å¦‚æœä½ æƒ³å…ˆç›´æ¥ç”¨ä½ çš„æ•°å­¦éš¾é¢˜æµ‹ä¸€ä¸‹æ¨¡å‹ï¼Œå¯è·³åˆ°è¿™ä¸ª[**æ¼”ç¤º**](https://huggingface.co/spaces/AI-MO/math-olympiad-solver)ç©ä¸€ç©ã€‚

æˆ‘ä»¬å¼€å§‹å§ï¼

- [NuminaMath æ˜¯å¦‚ä½•è£è†ºé¦–å±Š AIMO è¿›æ­¥å¥–çš„ï¼Ÿ](#numinamath-æ˜¯å¦‚ä½•è£è†ºé¦–å±Š-aimo-è¿›æ­¥å¥–çš„)
  - [Numina ç®€ä»‹ - å¼€æ”¾çš„ AI For Math è®¡åˆ’](#numina-ç®€ä»‹---å¼€æ”¾çš„-ai-for-math-è®¡åˆ’)
  - [AIMO å¥–](#aimo-å¥–)
  - [æˆ‘ä»¬çš„é¦–ä¸ªè¿›æ­¥å¥–è·å¥–è§£å†³æ–¹æ¡ˆ](#æˆ‘ä»¬çš„é¦–ä¸ªè¿›æ­¥å¥–è·å¥–è§£å†³æ–¹æ¡ˆ)
  - [è®­ç»ƒæ”»ç•¥](#è®­ç»ƒæ”»ç•¥)
  - [æ‰€éœ€æƒŸæ•°æ®](#æ‰€éœ€æƒŸæ•°æ®)
    - [æ€ç»´é“¾](#æ€ç»´é“¾)
    - [å·¥å…·æ•´åˆæ¨ç†](#å·¥å…·æ•´åˆæ¨ç†)
  - [é€šè¿‡è‡ªä¸€è‡´æ€§å·¥å…·æ•´åˆæ¨ç† (SC-TIR) æ¥æŠ‘åˆ¶é«˜æ³¢åŠ¨](#é€šè¿‡è‡ªä¸€è‡´æ€§å·¥å…·æ•´åˆæ¨ç†-sc-tir-æ¥æŠ‘åˆ¶é«˜æ³¢åŠ¨)
    - [é¿å…è¿‡æ‹Ÿåˆè¯…å’’](#é¿å…è¿‡æ‹Ÿåˆè¯…å’’)
  - [æˆ‘ä»¬å°è¯•è¿‡çš„å…¶ä»–ç‚¹å­](#æˆ‘ä»¬å°è¯•è¿‡çš„å…¶ä»–ç‚¹å­)
  - [Numina çš„æœªæ¥ - å¯»æ±‚è´¡çŒ®è€…å’Œåˆä½œä¼™ä¼´ï¼](#numina-çš„æœªæ¥---å¯»æ±‚è´¡çŒ®è€…å’Œåˆä½œä¼™ä¼´)
  - [è‡´è°¢](#è‡´è°¢)

## Numina ç®€ä»‹ - å¼€æ”¾çš„ AI For Math è®¡åˆ’

æ•°å­¦æ€»æœ‰ç‚¹ä¸ä¼—ä¸åŒåœ¨èº«ä¸Šï¼

äººäººåœ¨æ—¥å¸¸ä¸­éƒ½ä¼šæ¥è§¦æ•°å­¦ï¼Œå­©å­ä»¬ç”šè‡³è¿˜æœªè¯†å­—å°±å…ˆæ¥è§¦äº†æ•°å­¦ã€‚æœ‰å²ä»¥æ¥æœ€ä¼Ÿå¤§çš„æ•°å­¦å®¶ä¹‹ä¸€[**æ‹‰é©¬åŠªé‡‘**](https://en.wikipedia.org/wiki/Srinivasa_Ramanujan)äº 1887 å¹´å‡ºç”Ÿåœ¨å°åº¦çš„ä¸€ä¸ªæ™®é€šå®¶åº­ï¼Œé è‡ªå­¦æˆä¸ºä¸€ä»£å¤§å¸ˆã€‚æ¯ä¸ªäººä¸æ•°å­¦éƒ½æœ‰æˆ–å¤§æˆ–å°çš„äº¤é›†ï¼Œä»ç”¨å®ƒæ¶ˆé£åˆ°é å®ƒåƒé¥­å„æœ‰ä¸åŒã€‚

æ— æ³•å¦è®¤çš„æ˜¯ï¼Œæ•°å­¦å¯¹äººç±»è‡³å…³é‡è¦ï¼Œå•†ä¸šç¤¾ä¼šçš„ä¸€åˆ‡äº‹ç‰©ï¼Œä» iPhone åˆ°æ ¸ç”µç«™ç­‰ç­‰ï¼Œéƒ½æ ¹æ¤äºæ•°å­¦ä¹‹ä¸Šã€‚ä½†ï¼Œå°±ç®—æ˜¯çº¯é¢å‘åº”ç”¨çš„æ•°å­¦é—®é¢˜ï¼Œä¹Ÿè‡ªæœ‰å…¶è¶£å‘³ä¹‹å¤„ã€‚

çº¯ç²¹æ•°å­¦è¶…è¶Šäº†æ™ºåŠ›ï¼Œå°±å¦‚æ— è¾¹æ— é™…çš„æµ·æ´‹ï¼Œå”¯æœ‰å¿ƒçµæ‰å¯å¾œå¾‰å…¶ä¸­ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬å¯åŠ¨ [**Numina**](http://projectnumina.ai) æ—¶ï¼Œå¼€æºå’Œå¼€æ”¾æ•°æ®é›†æˆäº†è‡ªç„¶ä¹‹é€‰ã€‚ç›¸å¯¹äºäººç±»æ™ºèƒ½ï¼Œæˆ‘ä»¬è®¤ä¸ºäººå·¥æ™ºèƒ½å¯¹æ•°å­¦çš„è¿›æ­¥ä¹Ÿç†åº”èµ·åˆ°åº”æœ‰çš„å¹¿æ³›ä½œç”¨ã€‚å¦‚æœè®¡ç®—æœºæ˜¯æ€ç»´çš„è‡ªè¡Œè½¦ï¼Œé‚£ä¹ˆäººå·¥æ™ºèƒ½å°±æ˜¯å®ƒçš„å¼•æ“ â€”â€” å®ƒä¸ºæˆ‘ä»¬è¿™ä¸ªæ—¶ä»£çš„æ‹‰é©¬åŠªé‡‘æ‰“å¼€æ–°çš„è§†é‡ã€‚

è‚‡å§‹ï¼Œåœ¨ Mistral AI çš„æ”¯æŒä¸‹ï¼Œä¸€ç¾¤å¯¹äººå·¥æ™ºèƒ½å’Œæ•°å­¦å……æ»¡çƒ­æƒ…çš„äººäº 2023 å¹´åº•é›†ä½“åˆ›ç«‹ï¼ˆ[**Jia Li**](https://x.com/JiaLi52524397)ã€[**Yann Fleureau**](https://www.linkedin.com/in/yann-flureau-b1179983/)ã€[**Guillaume Lample**](https://x.com/GuillaumeLample)ã€[**Stan Polu**](https://x.com/spolu) ä»¥åŠ [**HÃ©lÃ¨ne Evain**](https://www.linkedin.com/in/h%C3%A9l%C3%A8ne-evain-473815b1)ï¼‰äº† Numinaï¼Œå…¶çµæ„Ÿæ¥è‡ªäºç”± Alex Gerko å’Œ XTX Markets å‘èµ·çš„äººå·¥æ™ºèƒ½æ•°å­¦å¥¥æ—åŒ¹å…‹ï¼ˆAI Math Olympiadï¼ŒAIMOï¼‰ç«èµ›ã€‚

2024 å¹´åˆï¼ŒNumina å›¢é˜Ÿè·å¾—äº†ä¸¤ä½æ¥è‡ª Hugging Face çš„ LLM å¾®è°ƒä¸“å®¶çš„æ”¯æŒ (ğŸ‘‹Â [**Lewis Tunstall**](https://x.com/_lewtun) å’Œ [**Ed Beeching**]( https://x.com/edwardbeeching)ï¼‰ä»è€Œå¼€å§‹ç«é€ [**2024 AIMO è¿›æ­¥å¥–**](https://www.kaggle.com/competitions/ai-mathematical-olympiad-prize)ã€‚éšåï¼Œæˆ‘ä»¬åˆè·å¾—äº† [**General Catalyst**](https://www.generalcatalyst.com/) å’Œ [**Answer.ai**](http://answer.ai/) çš„æ”¯æŒã€‚åˆ° 2024 å¹´ 3 æœˆï¼ŒNumina å·²èšé›†äº†ä¸€æ”¯[**æ¥è‡ªä¸–ç•Œå„åœ°çš„é¡¶å°–äººæ‰**](http://projectnumina.ai/about-us)å›¢é˜Ÿã€‚

å›¢é˜Ÿå°±ä½åï¼Œæ˜¯æ—¶å€™å¯¹ AIMO å‘èµ·æŒ‘æˆ˜äº†ï¼

## AIMO å¥–

æ¯å¹´ï¼Œæ¥è‡ªä¸–ç•Œå„åœ°çš„é«˜ä¸­ç”Ÿéƒ½ä¼šå‚åŠ [**å›½é™…æ•°å­¦å¥¥æ—åŒ¹å…‹ç«èµ›**](https://www.imo-official.org) - ä¸€é¡¹åŒ…å«å…­é“å¯Œæœ‰æŒ‘æˆ˜æ€§çš„é¢˜ç›®ï¼Œæ¨ªè·¨ä»£æ•°ã€å‡ ä½•ã€æ•°è®ºç­‰é¢†åŸŸçš„ç«èµ›ã€‚ä¸ºäº†è®©å¤§å®¶äº†è§£ç«èµ›çš„éš¾åº¦ï¼Œä¸‹é¢ç»™å‡ºäº†[**å»å¹´çš„ä¸€é“é¢˜**](https://www.imo-official.org/problems.aspx)ï¼š

![imo-problem.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/imo-problem.png)

2023 å¹´ 11 æœˆï¼Œ[**AIMO å¥–**](https://aimoprize.com)å¯åŠ¨ï¼Œæ—¨åœ¨æ¨åŠ¨æ“…é•¿æ•°å­¦æ¨ç†çš„äººå·¥æ™ºèƒ½æ¨¡å‹çš„å¼€æ”¾å¼å¼€å‘ã€‚è°èƒ½è®­å‡ºèƒ½å¤Ÿèµ¢å¾— IMO é‡‘ç‰Œçš„ AI æ¨¡å‹ï¼Œè°å°±ä¼šè·å¾— 500 ä¸‡ç¾å…ƒçš„å¤§å¥–ã€‚é™¤äº†å¤§å¥–ä¹‹å¤–ï¼ŒAIMO è¿˜æ¨å‡ºäº†ä¸€ç³»åˆ—**è¿›æ­¥å¥–**ï¼Œä»¥å¥–åŠ±åœ¨å®ç°è¿™ä¸€æœ€ç»ˆç›®æ ‡è¿‡ç¨‹ä¸­çš„é‡Œç¨‹ç¢‘æ€§å·¥ä½œã€‚é¦–ä¸ªè¿›æ­¥å¥–æ˜¯ä»¥ [**Kaggle ç«èµ›**](https://www.kaggle.com/competitions/ai-mathematical-olympiad-prize)çš„å½¢å¼ä¸¾è¡Œçš„ï¼Œå…¶é¢˜ç›®æ¯” IMO ä¸­çš„é¢˜ç›®*ç®€å•ä¸€äº›*ï¼Œç›¸å½“äº IMO é¢„é€‰èµ›çš„æ°´å¹³ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ç»™å‡ºäº†ä¸€ä¸ªä¾‹é¢˜ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ¯”ä¸Šé¢çš„ IMO é¢˜ç›®å®¹æ˜“ä¸€äº›ï¼Œä½†å¯¹ LLM æ¥è¯´ä»ç„¶å¾ˆæ£˜æ‰‹ï¼š

> ä»¤ $k, l > 0$ ä¸ºå‚æ•°ï¼ŒæŠ›ç‰©çº¿ $y = kx^2 - 2kx + l$ ä¸ç›´çº¿ $y = 4$ ç›¸äº¤äºä¸¤ç‚¹ $A$ å’Œ $B$ï¼Œä¸”ä¸¤ç‚¹è·ç¦»ä¸º 6ã€‚é—® $A$ åˆ°åŸç‚¹çš„è·ç¦» å’Œ $B$ åˆ°åŸç‚¹çš„è·ç¦»çš„å¹³æ–¹å’Œæ˜¯å¤šå°‘ï¼Ÿ

èµ›é¢˜åˆ†ä¸ºä¸¤ç»„ï¼Œæ¯ç»„ 50 é¢˜ï¼Œåˆ†åˆ«ä½œä¸ºå…¬å¼€æ’è¡Œæ¦œå’Œç§æœ‰æ’è¡Œæ¦œï¼Œç§æœ‰æ’è¡Œæ¦œçš„é¢˜ç›®æ˜¯å¯¹å‚èµ›è€…ä¸å¯è§çš„ã€‚è¿™äº›é¢˜ç›®çš„éš¾åº¦ä¸ [**AMC12**](https://artofproblemsolving.com/wiki/index.php/AMC_12) å’Œ [**AIME**](https://en.wikipedia.org/wiki/American_Invitational_Mathematics_Examination) è€ƒè¯•ç›¸å½“ï¼Œå…¶ç­”æ¡ˆå‡ä¸ºæ•´æ•°ã€‚æ¯”èµ›ç”¨ç§æœ‰æ’è¡Œæ¦œå†³å®šæœ€ç»ˆæ’åã€‚å‚èµ›è€…æ¯å¤©å¯ä»¥æäº¤ä¸¤æ¬¡ï¼Œä»…å¯ä½¿ç”¨ 2 æœˆ 23 æ—¥ä¹‹å‰å‘å¸ƒçš„å¼€æ”¾æ¨¡å‹ã€‚æ¯æ¬¡æäº¤éƒ½ä¼šåˆ†é…ä¸€ä¸ª P100 GPU æˆ– 2xT4 GPUï¼Œæœ€å¤šç»™ 9 ä¸ªå°æ—¶æ¥è§£å†³ 50 é“é¢˜ã€‚

è€ƒè™‘åˆ°ä¸Šè¿°è§„åˆ™å’Œé™åˆ¶ï¼Œç­–ç•¥é€‰æ‹©å¯¹äºæˆ‘ä»¬å¼€å‘åˆ¶èƒœæ–¹æ¡ˆè‡³å…³é‡è¦ã€‚

## æˆ‘ä»¬çš„é¦–ä¸ªè¿›æ­¥å¥–è·å¥–è§£å†³æ–¹æ¡ˆ

ç»è¿‡æ•´ä¸ªæ¯”èµ›çš„å¤šè½®è¿­ä»£ï¼Œæˆ‘ä»¬çš„é¦–ä¸ªè¿›æ­¥å¥–è§£å†³æ–¹æ¡ˆä¸»è¦ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š

- å¾®è°ƒ [**DeepSeekMath-Base 7B**](https://huggingface.co/deepseek-ai/deepseek-math-7b-base) çš„æ”»ç•¥ã€‚é€šè¿‡è¯¥æ”»ç•¥ï¼Œæˆ‘ä»¬å°†æ¨¡å‹æ‰“é€ æˆå¯ä»¥è§£å†³æ•°å­¦é¢˜çš„â€œæ¨ç†ä»£ç†â€ï¼Œå…¶å¯ä»¥é€šè¿‡æŠŠè‡ªç„¶è¯­è¨€æ¨ç†å’Œä½¿ç”¨ Python REPL è®¡ç®—ä¸­é—´ç»“æœç›¸ç»“åˆä»¥æœ€ç»ˆè§£å†³é—®é¢˜ã€‚
- ä¸€ç§å¸¦ä»£ç æ‰§è¡Œåé¦ˆçš„ã€ä¸ºå·¥å…·æ•´åˆæ¨ç†ï¼ˆtool-integrated reasoninï¼ŒTIRï¼‰è®¾è®¡çš„æ–°è§£ç ç®—æ³•ï¼Œä»¥åœ¨æ¨ç†è¿‡ç¨‹ä¸­ç”Ÿæˆå€™é€‰è§£ç­”ã€‚
- ç”¨æ¥æŒ‡å¯¼æ¨¡å‹é€‰æ‹©å¹¶é¿å…è¿‡æ‹Ÿåˆå…¬å¼€æ’è¡Œæ¦œçš„å„ç§å†…éƒ¨éªŒè¯é›†ã€‚

æˆ‘ä»¬ä½¿ç”¨äº†å¤šä¸ªå¼€æºåº“æ¥è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ï¼Œä¸»è¦æœ‰ [**TRL**](https://github.com/huggingface/trl)ã€[**PyTorch**](https://github.com/pytorch/pytorch)ã€[**vLLM**](https://github.com/vllm-project/vllm) ä»¥åŠ [**DeepSpeed**](https://github.com/microsoft/DeepSpeed)ã€‚åœ¨ä¸€ä¸ª 8xH100 GPU èŠ‚ç‚¹ä¸Šï¼Œæˆ‘ä»¬èŠ±äº† 10 ä¸ªå°æ—¶è®­æˆäº†æ¨¡å‹ã€‚

## è®­ç»ƒæ”»ç•¥

æˆ‘ä»¬é‡‡ç”¨çš„å¾®è°ƒæ–¹æ³•ä¸»è¦åŸºäº [**MuMath-Code è®ºæ–‡**](https://arxiv.org/abs/2405.07551)ï¼Œå…¶æ¨¡å‹è®­ç»ƒè¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š

![mumath.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/mumath.png)

  _MuMath-Code è®ºæ–‡ä¸­çš„ä¸¤é˜¶æ®µè®­ç»ƒæ–¹æ³•_

- **ç¬¬ 1 é˜¶æ®µï¼š** åœ¨è‡ªç„¶è¯­è¨€â€œæ•°å­¦é¢˜+è§£ç­”â€çš„å¤§è§„æ¨¡ã€å¤šæ ·åŒ–æ•°æ®é›†ä¸Šå¾®è°ƒåŸºç¡€æ¨¡å‹ï¼Œå…¶ä¸­æ¯ä¸ªè§£ç­”éƒ½éœ€å¥—ç”¨æ€ç»´é“¾ï¼ˆCoTï¼‰æ¨¡æ¿ä»¥ä¿ƒä½¿ LLM è¿›è¡Œæ¨ç†ã€‚
- **ç¬¬ 2 é˜¶æ®µï¼š** åœ¨å·¥å…·æ•´åˆæ¨ç†çš„åˆæˆæ•°æ®é›†ä¸Šå¾®è°ƒç¬¬ 1 é˜¶æ®µå¾—åˆ°çš„æ¨¡å‹ï¼Œå…¶ä¸­æ¯ä¸ªæ•°å­¦é¢˜éƒ½åˆ†è§£ä¸ºä¸€ç³»åˆ—æ¨ç†ã€Python ç¨‹åºåŠå…¶è¾“å‡ºã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬éµå¾ªå¾®è½¯çš„ [**ToRA è®ºæ–‡**](https://arxiv.org/abs/2309.17452)çš„åšæ³•ï¼Œæç¤º GPT-4 ä»¥ ToRA æ ¼å¼ç”Ÿæˆå¸¦æœ‰ä»£ç æ‰§è¡Œåé¦ˆçš„è§£ç­”ã€‚å¯¹è¿™äº›æ•°æ®è¿›è¡Œå¾®è°ƒä¼šäº§ç”Ÿä¸€ä¸ªæ¨ç†ä»£ç†ï¼Œå®ƒå¯ä»¥é€šè¿‡å°†è‡ªç„¶è¯­è¨€æ¨ç†å’Œä½¿ç”¨ Python REPL æ¥è®¡ç®—ä¸­é—´ç»“æœç»“åˆèµ·æ¥ä»¥è§£å†³æ•°å­¦é—®é¢˜ï¼ˆè¯·å‚è§ä¸‹å›¾ï¼‰ã€‚

    ![tora.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/tora.png)

    _æ¥è‡ª ToRA è®ºæ–‡çš„å›¾ï¼Œè¯¥è®ºæ–‡ä»‹ç»äº†æˆ‘ä»¬ç”¨æ¥è®­ç»ƒæ¨¡å‹çš„å·¥å…·é›†æˆæ¨ç†æ ¼å¼ã€‚_


è¿™ä¸¤ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬éƒ½ç”¨äº†â€œå…¨æ¨¡å‹å¾®è°ƒâ€ï¼Œæ‰€æœ‰æ¨¡å‹æƒé‡åœ¨åå‘ä¼ æ’­æœŸé—´éƒ½å¾—åˆ°äº†æ›´æ–°ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åƒ LoRA æˆ– DoRA è¿™æ ·çš„å‚æ•°é«˜æ•ˆæŠ€æœ¯ï¼Œå› ä¸ºæ²¡æœ‰å¤§é‡å®éªŒè¡¨æ˜å®ƒä»¬èƒ½å¤Ÿåª²ç¾å…¨æ¨¡å‹å¾®è°ƒçš„æ€§èƒ½ã€‚æˆ‘ä»¬ä½¿ç”¨ TRL çš„ `SFTTrainer` ä¸­çš„â€œå¡«å……â€åŠŸèƒ½å°†å¤šä¸ªæ ·æœ¬ä¸²æ¥åˆ°ä¸€ä¸ª 2048 ä¸ªè¯å…ƒçš„å—ä¸­ã€‚æ‰€æœ‰æ¨¡å‹æ¨¡å‹éƒ½ä½¿èƒ½äº†æ¢¯åº¦ checkpointing è®­ç»ƒï¼Œå¹¶ä½¿ç”¨ DeepSpeed ZeRO-3 è¿›è¡Œåˆ†ç‰‡ï¼Œä»¥ç¡®ä¿æƒé‡ã€æ¢¯åº¦å’Œä¼˜åŒ–å™¨çŠ¶æ€èƒ½å¤Ÿæ”¾è¿› VRAMã€‚ä¸¤ä¸ªé˜¶æ®µä½¿ç”¨çš„ä¸»è¦è¶…å‚å¦‚ä¸‹ï¼š

|                  | 1 é˜¶æ®µ| 2 é˜¶æ®µ|
|------------------|---------|---------|
| å­¦ä¹ ç‡           | 2.0 E-5 | 2.0 E-5 |
| æ€» batch size    | 32      | 32      |
| å—å¤§å°       | 2048    | 1024    |
| epoch æ•°       | 3       | 4       |
| å­¦ä¹ ç‡è°ƒåº¦å™¨     | cosine  | cosine  |
| é¢„çƒ­ç‡     | 0.1     | 0.1     |

é¦–æ¬¡æäº¤æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† `DeepSeek 7B` æ¨¡å‹ï¼Œæˆ‘ä»¬ä»…å¯¹å®ƒè¿›è¡Œäº†ç¬¬ 1 é˜¶æ®µå¾®è°ƒï¼Œä½†æˆ‘ä»¬å‘ç°æ€§èƒ½ç›¸å½“æœ‰é™ï¼Œå…¶åœ¨å…¬å¼€æ’è¡Œæ¦œä¸Šçš„æœ€ä½³ maj@32 æˆç»©ä»…ä¸º 8/50ã€‚[**Abdur Raâ€‹â€‹fae**](https://www.kaggle.com/abdurrafae) çš„[**å…¬å¼€ç¬”è®°æœ¬**](https://www.kaggle.com/code/abdurrafae/improved-code-interpretation)ä¿ƒä½¿æˆ‘ä»¬è€ƒè™‘åœ¨è®­ç»ƒæ–¹æ¡ˆä¸­åŠ å…¥ä»£ç æ‰§è¡Œã€‚æœ€åˆï¼Œæˆ‘ä»¬ä¸“æ³¨äº [**MMOSï¼ˆMix of Minimal Optimal Setsï¼‰**](https://github.com/cyzhh/MMOS) æ•°æ®é›†ã€‚æˆ‘ä»¬å‘ç°ä½¿ç”¨ MMOS è™½ç„¶æé«˜äº†æ€§èƒ½ï¼Œä½†åœ¨å…¬å¼€æ’è¡Œæ¦œä¸Šçš„ maj@32 æœ€é«˜åˆ†ä»åªæœ‰ 16/50ï¼Œæˆ‘ä»¬å½“æ—¶æœ›æ–‡ç”Ÿä¹‰åœ°çŒœæµ‹å…¶åŸå› æ˜¯ MMOS ä»…åŒ…å«å•è½®è§£ï¼ˆå³è¯¥æ¨¡å‹ä»…ç”Ÿæˆå•ä¸ª Python ç¨‹åºï¼Œè¿™ä¸è¶³ä»¥è§£å†³éš¾é¢˜ï¼‰ã€‚åæ¥ï¼Œæˆ‘ä»¬æ„è¯†åˆ° MMOS æ˜¯ä¸€ä¸ªè¯¯ç§°ï¼Œè¯¥ Kaggle ç¬”è®°æœ¬å®é™…ä¸Šä½¿ç”¨çš„æ˜¯ [**DeepSeekMath 7B RL**](https://huggingface.co/deepseek-ai/deepseek-math-7b-rl) æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒèƒ½å¤Ÿè¿›è¡Œå¤šæ­¥æ¨ç†åŠä»£ç æ‰§è¡Œã€‚

ç»æ­¤ä¸€å½¹ï¼Œæˆ‘ä»¬æƒ³é›†ä¸­ç²¾åŠ›ç”Ÿæˆä¸€ä¸ªä¸ DeepSeekMath Instruct/RL æ¨¡å‹ä½¿ç”¨çš„æ•°æ®é›†ç±»ä¼¼çš„æ•°æ®é›†ï¼Œè¿™ä¸€åšæ³•ä¸ MuMath-Code æ”»ç•¥ç»“åˆåï¼Œå¸¦æ¥äº†æ˜¾è‘—çš„æ”¹è¿›ã€‚

ä¸‹é¢ï¼Œä¸€èµ·æ¥çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦‚ä½•æ„å»ºè¿™äº›æ•°æ®é›†çš„å§ã€‚

## æ‰€éœ€æƒŸæ•°æ®

åœ¨æ„å»ºæ•°æ®é›†æ—¶ï¼Œæˆ‘ä»¬å¹¿æ³›å‚è€ƒäº† DeepSeek Math å’Œå…¶ä»–å­¦è€…çš„æ–¹æ³•ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œäº†å¤§å¹…æ‰©å±•ã€‚æˆ‘ä»¬ç”Ÿæˆäº†å«æ•°åä¸‡*æ•°å­¦é¢˜-è§£ç­”*å¯¹çš„å¾®è°ƒæ•°æ®é›†ï¼Œæ¶µç›–ä»é«˜ä¸­æ•°å­¦åˆ°ç«èµ›çº§æ•°å­¦çš„å„ç§çŸ¥è¯†ç‚¹ã€‚æ¥ä¸‹æ¥çš„å‡ å‘¨ï¼Œæˆ‘ä»¬ä¼šå°†è¯¥æ•°æ®é›†å®Œå…¨å¼€æºã€‚åŒæ—¶ã€‚æˆ‘ä»¬è¿˜å¯èƒ½ä¼šç”¨æ›´å¤§çš„æ¨¡å‹æ¥æ£€æŸ¥æˆ‘ä»¬æ”»ç•¥çš„å¯æ‰©å±•æ€§ã€‚æœ‰å…³æ•°æ®é›†æ„å»ºçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬å³å°†å‘å¸ƒçš„æ•°æ®é›†æŠ€æœ¯æŠ¥å‘Šã€‚

å…·ä½“åˆ°è¿™æ¬¡è¿›æ­¥å¥–ï¼Œæˆ‘ä»¬ä¸ºæ­¤æ„å»ºäº†ä¸¤ä¸ªæ•°æ®é›†ä»¥å¾®è°ƒæ¨¡å‹ã€‚

### æ€ç»´é“¾

è¯¥æ•°æ®é›†ç”±æ•°åä¸‡ä¸ªé¢˜ç›®ç»„æˆï¼Œæ¯é¢˜éƒ½æœ‰ä»¥æ€ç»´é“¾çš„æ–¹å¼ç¼–å†™çš„è§£ç­”ã€‚æ•°æ®é›†çš„æ¥æºèŒƒå›´æœ‰ä¸­å›½é«˜ä¸­æ•°å­¦ç»ƒä¹ ä»¥åŠç¾å›½åŠå›½é™…æ•°å­¦å¥¥æ—åŒ¹å…‹ç«èµ›é¢˜ç›®ã€‚æ•°æ®ä¸»è¦æ¥è‡ªåœ¨çº¿è¯•å· PDF å’Œæ•°å­¦è®ºå›ã€‚

å¤„ç†æ­¥éª¤å¦‚ä¸‹ï¼š

1. å¯¹åŸå§‹ PDF è¿›è¡Œ OCRã€‚
2. åˆ†å‰²ä¸ºâ€œé¢˜ç›®-è§£ç­”â€å¯¹ã€‚
3. ç¿»è¯‘æˆè‹±æ–‡ã€‚
4. é‡æ–°è°ƒæ•´ä»¥å˜æˆæ€ç»´é“¾æ¨ç†æ ¼å¼ã€‚
5. æ ¼å¼åŒ–ä¸ºæœ€ç»ˆç­”æ¡ˆã€‚

### å·¥å…·æ•´åˆæ¨ç†

å·¥å…·æ•´åˆæ¨ç†ï¼ˆTIRï¼‰åœ¨æœ¬æ¬¡æ¯”èµ›ä¸­å‘æŒ¥äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ç„¶è€Œï¼Œæ”¶é›†å’Œæ ‡æ³¨æ­¤ç±»æ•°æ®æ—¢æ˜‚è´µåˆè€—æ—¶ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä» Numina æ•°æ®é›†ä¸­é€‰æ‹©äº†å¤§çº¦ 6 ä¸‡é“é¢˜ï¼Œé‡ç‚¹å…³æ³¨é‚£äº›ç­”æ¡ˆä¸ºæ•°å­—çš„é¢˜ï¼Œå…¶ä¸­å¤§å¤šæ•°ç­”æ¡ˆæ˜¯æ•´æ•°ã€‚

ç„¶åï¼Œæˆ‘ä»¬åˆ©ç”¨ GPT-4 çš„æµæ°´çº¿ç”Ÿæˆç±»ä¼¼ TORA çš„æ¨ç†è·¯å¾„ï¼Œæ‰§è¡Œä»£ç å¹¶ç”Ÿæˆç»“æœï¼Œç›´åˆ°ç”Ÿæˆå®Œæ•´è§£ç­”ã€‚æˆ‘ä»¬ç­›é€‰å‡ºæœ€ç»ˆç­”æ¡ˆä¸å‚è€ƒç­”æ¡ˆä¸åŒ¹é…çš„è§£ç­”ï¼Œå¹¶é‡å¤æ­¤è¿‡ç¨‹ä¸‰æ¬¡ï¼Œä»¥ç¡®ä¿å‡†ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚è¿™ç§è¿­ä»£æ–¹æ³•ä½¿æˆ‘ä»¬èƒ½å¤Ÿé«˜æ•ˆåœ°ç”Ÿæˆé«˜è´¨é‡çš„ TORA æ•°æ®ã€‚

ä½œä¸ºå‚è€ƒï¼Œä»¥ä¸‹æ˜¯æˆ‘ä»¬è®­å¾—çš„ç¬¬ 1 é˜¶æ®µæ¨¡å‹ **NuminaMath-7B-CoT** å’Œç¬¬ 2 é˜¶æ®µæ¨¡å‹ **NuminaMath-7B-TIR** åœ¨ [**MATH åŸºå‡†**](https://arxiv.org/abs/2103.03874)ä¸Šä¸å…¶ä»–å¼€æ”¾åŠç§æœ‰æ¨¡å‹çš„è·‘åˆ†å¯¹æ¯”ï¼š

| æ¨¡å‹                    | MATH (%)                       |
|--------------------------|--------------------------------|
|                          | **æ€ç»´é“¾æ¨ç†** |
| GPT-4 (2023)             | 42.5                           |
| GPT-4o                   | 76.6                           |
| Claude 3.5 Sonnet        | 71.1                           |
| DeepSeekMath-7B-Instruct | 46.8                           |
| DeepSeekMath-7B-RL       | 51.7                           |
| NuminaMath-7B-CoT        | 56.3                           |
|                          | **å·¥å…·æ•´åˆæ¨ç†**  |
| DeepSeekMath-7B-Instruct | 57.4                           |
| DeepSeekMath-7B-RL       | 58.8                           |
| NuminaMath-7B-TIR        | 68.2                           |

*å„æ¨¡å‹åœ¨ MATH åŸºå‡†ä¸Šçš„è¡¨ç°ã€‚é™¤éæ˜ç¡®è¯´æ˜ï¼Œæ‰€æœ‰è·‘åˆ†å‡ç”±é›¶æ ·æœ¬è´ªå¿ƒè§£ç è·å¾—ã€‚*

## é€šè¿‡è‡ªä¸€è‡´æ€§å·¥å…·æ•´åˆæ¨ç† (SC-TIR) æ¥æŠ‘åˆ¶é«˜æ³¢åŠ¨

æ­£å¦‚å…¶ä»–å‚èµ›è€…æŒ‡å‡ºçš„é‚£æ ·ï¼Œæœ¬æ¬¡æ¯”èµ›åœ¨æ¨¡å‹æäº¤å’Œè¯„ä¼°æ–¹é¢éƒ½å¸¦æ¥äº†ä¸€äº›æŒ‘æˆ˜ï¼š

- è¯„ä¼° API ä»¥éšæœºé¡ºåºå‡ºé¢˜ï¼Œå› æ­¤æå‰åœæ­¢ç­‰ç­–ç•¥ä¼šäº§ç”Ÿè¾ƒé«˜çš„æ³¢åŠ¨ï¼Œå› ä¸ºå¯èƒ½ä¸€å¼€å§‹å°±ä¼šé‡åˆ°å¾ˆå¤šéš¾é¢˜ï¼Œè¿™å°±å¯¼è‡´ç•™ç»™å‰©ä½™éƒ¨åˆ†çš„æ—¶é—´å°±ä¸å¤šäº†ï¼ˆåä¹‹äº¦ç„¶ï¼‰ã€‚
- LLM æ¨ç†ä¸­çš„å¤§å¤šæ•°åˆ›æ–°éƒ½æ˜¯åŸºäºæœ€æ–°çš„ GPU çš„ï¼Œå› æ­¤ `Flash Attention 2` æˆ– `torch.compile` ç­‰æ ‡å‡†æ–¹æ³•ä¸é€‚ç”¨äº T4 GPUã€‚åŒæ ·ï¼Œè€ GPU å¹¶ä¸æ”¯æŒ bfloat16 ç­‰æ–°æ•°æ®ç±»å‹ï¼Œè¿™ä¿ƒä½¿æˆ‘ä»¬æ¢ç´¢ AWQ å’Œ GPTQ ç­‰è®­åé‡åŒ–æ–¹æ³•ã€‚

æœ€åˆï¼Œæˆ‘ä»¬ä½¿ç”¨ [**Abdur Raâ€‹â€‹fae**](https://www.kaggle.com/abdurrafae) çš„[**å…¬å¼€ç¬”è®°æœ¬**](https://www.kaggle.com/code/abdurrafae/improved-code-interpretation)æ¥æäº¤ï¼Œä½†å‘ç°é«˜æ³¢åŠ¨æ˜¯ä¸ªå¤§é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é‡‡å–äº†ä¸€ç§åŸºäºå·¥å…·æ•´åˆæ¨ç†çš„æ–°æ–¹æ³•ï¼š

![sc-tir.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/sc-tir.png)

1. å°†æ¯é“é¢˜å¤åˆ¶ N æ¬¡ä»¥ç”Ÿæˆ vLLM çš„ä¸€ä¸ª batchã€‚N å¯ä»¥çœ‹æˆå¤šæ•°æŠ•ç¥¨æ—¶çš„å€™é€‰æ•°é‡ã€‚
2. å¯¹è¿™ N ä¸ªè¾“å…¥è¿›è¡Œé‡‡æ ·è§£ç ï¼Œç›´è‡³ç”Ÿæˆå®Œæ•´çš„ Python ä»£ç å—ã€‚
3. æ‰§è¡Œæ¯ä¸ª Python ä»£ç å—å¹¶å°†å…¶è¾“å‡ºä¸²æ¥åœ¨ä»£ç åé¢ï¼ŒåŒ…æ‹¬æ ˆå›æº¯ï¼ˆå¦‚æœ‰ï¼‰ã€‚
4. é‡å¤ M æ¬¡ä»¥ç”Ÿæˆ N ä¸ªã€æ·±åº¦ä¸º M çš„ç”Ÿæˆï¼Œå…è®¸æ¨¡å‹ä½¿ç”¨æ ˆå›æº¯è‡ªçº æ­£ä»£ç é”™è¯¯ã€‚å¦‚æœæŸä¸ªæ ·æœ¬æ— æ³•ç”Ÿæˆåˆç†çš„è¾“å‡ºï¼ˆå¦‚ï¼Œç”Ÿæˆäº†ä¸å®Œæ•´çš„ä»£ç å—ï¼‰ï¼Œå°±åˆ é™¤ä¹‹ã€‚
5. å¯¹å€™é€‰è§£ç­”è¿›è¡Œåå¤„ç†ï¼Œå¹¶ä½¿ç”¨å¤šæ•°æŠ•ç¥¨æ¥é€‰æ‹©æœ€ç»ˆç­”æ¡ˆã€‚

æˆ‘ä»¬è·èƒœçš„æäº¤ä½¿ç”¨çš„ `N=48ï¼ŒM=4`ã€‚å› ä¸ºå¢åŠ ä»»ä¸€å‚æ•°çš„æ•°å€¼å¹¶ä¸ä¼šæé«˜æ€§èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±é€‰æ‹©äº†è¿™ä¸¤ä¸ªæœ€å°å€¼ä»¥ä¿è¯æ»¡è¶³æ—¶é—´é™åˆ¶ã€‚å®é™…ä¸Šï¼Œè¯¥ç®—æ³•é€šè¿‡å·¥å…·æ•´åˆæ¨ç†å¢å¼ºäº† [**CoT çš„è‡ªä¸€è‡´æ€§**](https://arxiv.org/abs/2305.10601)ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ã€‚

![imo-problem.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/tot.png)

æˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬çš„ SC-TIR ç®—æ³•äº§ç”Ÿäº†æ›´ç¨³å¥çš„ç»“æœï¼Œå¹¶ä¸”æ˜¾è‘—é™ä½äº†åœ¨å†…éƒ¨è¯„ä¼°é›†å’Œå…¬å¼€æ’è¡Œæ¦œä¸Šçš„æ³¢åŠ¨ã€‚

å€¼å¾—ä¸€æçš„ä¸€ä¸ªæŠ€æœ¯ç»†èŠ‚æ˜¯ï¼Œæˆ‘ä»¬å‘ç°ä»¥ 8 æ¯”ç‰¹ç²¾åº¦é‡åŒ–æ¨¡å‹å¾ˆæœ‰ç”¨ã€‚åŸå› æœ‰ä¸‰ï¼š

- å°†æ¨¡å‹ä¸Šä¼ åˆ° Kaggle Hub éå¸¸æ…¢ï¼Œå‹ç¼©æ¨¡å‹ä½¿ä¸Šä¼ é€Ÿåº¦æé«˜äº†ä¸€å€ã€‚
- T4 GPU ä¸æ”¯æŒ bfloat16ï¼Œè½¬æ¢ä¸º float16 ä¼šå¯¼è‡´æ¨¡å‹æ€§èƒ½ä¸‹é™ã€‚åˆæ²¡æ³•è½¬æ¢ä¸º float32ï¼Œå› ä¸ºè¶…å‡ºäº† GPU å¯ç”¨å†…å­˜ã€‚
- æ­¤å¤–ï¼Œ16 ä½æ¨¡å‹ä»…ç”¨äºåŠ è½½æƒé‡å°±éœ€æ¶ˆè€—çº¦ 32GB VRAMã€‚å¯¹äº 2xT4ï¼Œéœ€è¦ä½¿èƒ½ KV ç¼“å­˜æ‰èƒ½å¿«é€Ÿè¿è¡Œï¼Œæˆ‘ä»¬å‘ç°åœ¨æ¨¡å‹ç²¾åº¦å’Œé€Ÿåº¦ä¹‹é—´è¿›è¡ŒæŠ˜è¡·æ˜¯æœ‰ç›Šçš„ã€‚

æˆ‘ä»¬ä½¿ç”¨ [**AutoGPTQ**](https://github.com/AutoGPTQ/AutoGPTQ) ä»¥åŠç”¨äºæ ¡å‡†æ•°æ®é›†æ¥é‡åŒ–æˆ‘ä»¬çš„æ¨¡å‹ã€‚åœ¨å®è·µä¸­ï¼Œè¿™ä¼šå¯¼è‡´å‡†ç¡®æ€§å°å¹…ä¸‹é™ï¼Œä½†æä¾›äº†æœ€ä½³æŠ˜è¡·æ–¹æ¡ˆï¼Œä»¥é€‚é… Kaggle å¹³å°å¯¹æ¨¡å‹è¯„ä¼°æ‰€æ–½åŠ çš„é™åˆ¶ã€‚

### é¿å…è¿‡æ‹Ÿåˆè¯…å’’

è¿‡æ‹Ÿåˆå…¬å¼€æ’è¡Œæ¦œæ˜¯ Kaggle ç«èµ›ä¸­çš„å¸¸è§é£é™©ï¼Œå½“æµ‹è¯•é›†åªæœ‰ 50 é“é¢˜æ—¶æ›´æ˜¯å¦‚æ­¤ã€‚æ­¤å¤–ï¼Œè§„åˆ™å…è®¸æ¯å¤©æœ€å¤šæäº¤ä¸¤æ¬¡ï¼Œè¿™ä½¿å¾—å¼ºå¤§çš„å†…éƒ¨éªŒè¯æ•°æ®é›†å¯¹äºæˆ‘ä»¬çš„å¼€å‘èŠ‚å¥è‡³å…³é‡è¦ã€‚æ ¹æ® AIMO å›¢é˜Ÿçš„è§„å®šï¼Œæµ‹è¯•é¢˜çš„éš¾åº¦ä¸ºä¸­ç­‰ï¼Œä»‹äº AMC12 å’Œ AIME çº§åˆ«ä¹‹é—´ï¼Œä¸”æ¯é¢˜ç­”æ¡ˆä¸ºæ•´æ•°ã€‚

ä¸ºäº†æŒ‡å¯¼æ¨¡å‹é€‰æ‹©ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å››ä¸ªå†…éƒ¨éªŒè¯é›†æ¥è¡¡é‡æ¨¡å‹åœ¨ä¸åŒéš¾åº¦çš„æ•°å­¦é¢˜ä¸Šçš„æ€§èƒ½ã€‚ä¸ºäº†é¿å…åŸºç¡€æ¨¡å‹ä¸­æ½œåœ¨çš„æ•°æ®æ±¡æŸ“ï¼Œæˆ‘ä»¬ä» AMC12ï¼ˆ2022ã€2023ï¼‰å’Œ AIMEï¼ˆ2022ã€2023ã€2024ï¼‰ä¸­é€‰æ‹©é¢˜ç›®ä»¥åˆ›å»ºä¸¤ä¸ªå†…éƒ¨éªŒè¯æ•°æ®é›†ï¼š

- **AMCï¼ˆ83 é“é¢˜ï¼‰ï¼š** æˆ‘ä»¬é€‰æ‹©äº† [**AMC12**](https://artofproblemsolving.com/wiki/index.php/AMC_12_Problems_and_Solutions) 22ã€AMC12 23 çš„æ‰€æœ‰é¢˜ç›®ï¼Œå¹¶ä¿ç•™äº†é‚£äº›ç»“æœä¸ºæ•´æ•°çš„é¢˜ç›®ã€‚æœ€ç»ˆç”Ÿæˆçš„æ•°æ®é›†åŒ…å« 83 é“é¢˜ã€‚è¯¥éªŒè¯é›†æ—¨åœ¨æ¨¡æ‹Ÿ Kaggle ä¸Šçš„ç§æœ‰æµ‹è¯•é›†ï¼Œå› ä¸ºæˆ‘ä»¬ä»ç«èµ›æè¿°ä¸­çŸ¥é“é¢˜ç›®éš¾åº¦å¤§äºç­‰äºè¿™ä¸ªçº§åˆ«ã€‚æˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥è§£ç­”å¤§çº¦ 60-65% çš„é¢˜ç›®ã€‚ä¸ºäº†æµ‹é‡æ³¢åŠ¨ï¼Œæ¯æ¬¡è¯„ä¼°æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ 5-10 ä¸ªä¸åŒçš„ç§å­ï¼Œä½¿ç”¨æˆ‘ä»¬çš„ SC-TIR ç®—æ³•é€šå¸¸ä¼šçœ‹åˆ°å¤§çº¦ 1-3% çš„æ³¢åŠ¨ã€‚
- **AIMEï¼ˆ90 é“é¢˜ï¼‰ï¼š** æˆ‘ä»¬é€‰æ‹©äº† [**AIME 22**](https://artofproblemsolving.com/wiki/index.php/2022_AIME_I)ã€[**AIME 23**](https://artofproblemsolving.com/wiki/index.php/2023_AIME_I_Problems) ä»¥åŠ [**AIME 24**](https://artofproblemsolving.com/wiki/index.php/2024_AIME_I) çš„æ‰€æœ‰é¢˜ç›®æ¥åº¦é‡æˆ‘ä»¬æ¨¡å‹è§£å†³éš¾é¢˜çš„è¡¨ç°å¦‚ä½•ï¼Œå¹¶è§‚æµ‹æœ€å¸¸è§çš„é”™è¯¯æ¨¡å¼ã€‚åŒä¸Šï¼Œæ¯æ¬¡è¯„ä¼°ï¼Œæˆ‘ä»¬ä½¿ç”¨ 5-10 ä¸ªç§å­è¿›è¡Œä»¥æµ‹é‡æ³¢åŠ¨ã€‚

ç”±äº AMC/AIME éªŒè¯é›†è§„æ¨¡è¾ƒå°ï¼Œä¸å…¬å¼€æ’è¡Œæ¦œç±»ä¼¼ï¼Œè¿™äº›æ•°æ®é›†ä¸Šçš„æ¨¡å‹æ€§èƒ½å®¹æ˜“å—å™ªå£°çš„å½±å“ã€‚ä¸ºäº†æ›´å¥½åœ°è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨ MATH æµ‹è¯•é›†çš„å­é›†ï¼ˆå« 5,000 é“é¢˜ï¼‰å¯¹å…¶è¿›è¡Œäº†è¯„ä¼°ã€‚æˆ‘ä»¬ä»…ä¿ç•™ç­”æ¡ˆä¸ºæ•´æ•°çš„é¢˜ç›®ï¼Œä»¥ç®€åŒ–å¤šæ•°æŠ•ç¥¨å¹¶æ¨¡æ‹Ÿå¥¥èµ›è¯„ä¼°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åˆå¤šäº†ä¸¤ä¸ªéªŒè¯é›†ï¼š

- **MATH 4 çº§ï¼ˆ754 é“é¢˜ï¼‰**
- **MATH 5 çº§ï¼ˆ721 é“é¢˜ï¼‰**

é€šè¿‡ä½¿ç”¨è¿™å››ä¸ªéªŒè¯é›†ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸åŒçš„è®­ç»ƒé˜¶æ®µé€‰æ‹©æœ€æœ‰æ½œåŠ›çš„æ¨¡å‹ï¼Œå¹¶ç¼©å°è¶…å‚çš„é€‰æ‹©èŒƒå›´ã€‚æˆ‘ä»¬å‘ç°ï¼Œå¯¹æœ¬ AIMO èµ›ç¨‹è€Œè¨€ï¼Œå°†å°å‹ä½†å…·ä»£è¡¨æ€§çš„éªŒè¯é›†ä¸è¾ƒå¤§çš„éªŒè¯é›†ç›¸ç»“åˆæ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºæ¯ä¸ªæäº¤éƒ½å—åˆ°æŠ½æ ·éšæœºæ€§çš„å½±å“ã€‚

## æˆ‘ä»¬å°è¯•è¿‡çš„å…¶ä»–ç‚¹å­

ä¸Šæ–‡æœ‰æåŠï¼Œæˆ‘ä»¬åœ¨è¿‡ç¨‹ä¸­è¿˜å°è¯•äº†ä¸€äº›å…¶ä»–æ–¹æ³•ï¼Œä½†æœ€ç»ˆæ”¾å¼ƒï¼Œè½¬è€Œé‡‡ç”¨ MuMath-Code çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°è¯•è¿‡çš„æ–¹æ³•æœ‰ï¼š

- è®­ç»ƒçº¯ CoT æ¨¡å‹å¹¶ä½¿ç”¨å¤šæ•°æŠ•ç¥¨è¿›è¡Œè¯„ä¼°
- è®­ç»ƒ MMOS æ¨¡å‹ä»¥é€šè¿‡ Python ä¸€æ­¥è§£å†³é—®é¢˜

æˆ‘ä»¬è¿˜è¯•è¿‡å¯¹ SFT æ¨¡å‹ç”Ÿæˆçš„è¡¥å…¨åº”ç”¨ [**Kahneman-Tversky Optimization (KTO)**](https://arxiv.org/abs/2402.01306)ï¼Œå…·ä½“æƒ³æ³•æœ‰ç‚¹ç±»ä¼¼äº[**OrcaMath**](https://arxiv.org/abs/2402.14830)ï¼Œå³ï¼š

- äº¤ç»‡ä½¿ç”¨æ¨ç†å’Œä»£ç æ‰§è¡Œï¼Œæ¯é“é¢˜ç”¨ SFT æ¨¡å‹é‡‡æ ·å‡º 4 ä¸ªè¡¥å…¨ã€‚æˆ‘ä»¬ä½¿ç”¨ç¬¬ 2 é˜¶æ®µçš„ SFT æ•°æ®é›†ä½œä¸ºæç¤ºã€‚
- æå–ç­”æ¡ˆå¹¶å°†å…¶ä¸æ ‡æ³¨ç­”æ¡ˆè¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ­£ç¡®ï¼Œåˆ™å°†æ ·æœ¬æ ‡è®°ä¸ºæ­£ï¼Œå¦åˆ™æ ‡è®°ä¸ºè´Ÿã€‚
- åœ¨æ­¤æ•°æ®é›†ä¸Šå¯¹ SFT æ¨¡å‹åº”ç”¨ KTOã€‚

æˆ‘ä»¬å‘ç°è¿™ç§å½¢å¼çš„åŒç­– KTO ç”Ÿæˆçš„æ¨¡å‹æ¯” SFT æ¨¡å‹ç¨å¥½ï¼ˆå†…éƒ¨è¯„ä¼°å¥½å‡ ä¸ªç™¾åˆ†ç‚¹ï¼‰ï¼Œåœ¨å…¬å¼€æ’è¡Œæ¦œä¸Šå¾—åˆ†ä¸º 27/50ã€‚

KTO çš„ä¸€ä¸ªå¾ˆå¥½çš„åŠŸèƒ½æ˜¯ï¼Œä½ å¯ä»¥åœ¨è®­ç»ƒæœŸé—´è·Ÿè¸ªéšå¼å¥–åŠ±ï¼Œè¿™ç¡®å®æœ‰åŠ©äºè°ƒè¯• - å¦‚ï¼Œä¸‹å›¾å±•ç¤ºäº†æˆ‘ä»¬æˆåŠŸçš„è®­ç»ƒæ—¥å¿—ä¹‹ä¸€ï¼Œå…¶ä¸­äººä»¬å¯ä»¥çœ‹åˆ°æ­£ç¡®ç­”æ¡ˆçš„å¥–åŠ±éšç€è®­ç»ƒè€Œå¢åŠ ï¼Œè€Œé”™è¯¯ç­”æ¡ˆçš„å¥–åŠ±åˆ™è¢«æŠ‘åˆ¶ã€‚

![kto.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/kto.png)

ä½†ï¼Œç”±äºæ—¶é—´å…³ç³»ï¼Œæˆ‘ä»¬æœ€ç»ˆæ²¡æœ‰å°†æ­¤æ–¹æ³•åº”ç”¨äºæœ€ç»ˆçš„ SFT æ¨¡å‹ã€‚å¦‚æœæˆ‘ä»¬åšäº†çš„è¯ï¼Œå¯èƒ½è¿˜èƒ½å¤šåšå¯¹ 1-2 é“é¢˜ï¼

æˆ‘ä»¬è¿˜å°è¯•å°†æˆ‘ä»¬çš„ SFT æ”»ç•¥åº”ç”¨äº InternLM-20Bã€CodeLama-33B å’Œ Mixtral-8x7B ç­‰æ›´å¤§çš„æ¨¡å‹ï¼Œä½†å‘ç°ï¼ˆaï¼‰DeepSeek 7B æ¨¡å‹ç”±äºå·²åœ¨æ•°å­¦ä¸Šè¿›è¡Œè¿‡å¢é‡é¢„è®­ç»ƒè€Œå¾ˆéš¾è¢«å‡»è´¥ï¼Œä¸”ï¼ˆbï¼‰åœ¨ 2xT4 GPU ä¸Šæ¨ç†é€Ÿåº¦éå¸¸æ…¢ï¼Œå¹¶ä¸”æˆ‘ä»¬é‡åˆ°äº†è®¸å¤šç¥ç§˜çš„è¶…æ—¶ï¼Œä½†æˆ‘ä»¬æ— æ³•åˆ†æåˆ°å…¶æ ¹å› ã€‚

è¿˜æœ‰ä¸€ä¸ªå¤±è´¥çš„å®éªŒæ˜¯å°è¯•å°†å¼ºåŒ–å­¦ä¹ ï¼ˆç‰¹åˆ«æ˜¯ PPO ç®—æ³•åŠ [**Reinforce-Leave-One-Outï¼ˆRLOOï¼‰ç®—æ³•**](https://arxiv.org/abs/2402.14740)ï¼‰å’Œä»£ç æ‰§è¡Œåé¦ˆç»“åˆèµ·æ¥ä»¥ç”Ÿæˆå¯¹ç¼–å†™ä»£ç åŠè·å¾—æ­£ç¡®/é”™è¯¯è§£ç­”çš„å¥–åŠ±ã€‚æˆ‘ä»¬å°†å…¶åº”ç”¨äº `DeepSeekMath 7B RL` æ¨¡å‹ã€‚è™½ç„¶æˆ‘ä»¬çœ‹åˆ°äº†ä¸€äº›å¾ˆä¸é”™çš„å¥–åŠ±æ›²çº¿ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°æ€§èƒ½æœ‰ä»»ä½•æ˜¾è‘—çš„æå‡ã€‚é‰´äºåƒ RLOO è¿™æ ·çš„åœ¨çº¿æ–¹æ³•å—é™äºæ–‡æœ¬ç”Ÿæˆçš„æ€§èƒ½å¹¶ä¸”è¿­ä»£ç¼“æ…¢ï¼Œæˆ‘ä»¬æ”¾å¼ƒäº†å¼ºåŒ–å­¦ä¹ ï¼Œè½¬è€Œå°è¯• KTOã€‚

![rloo.png](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/winning-aimo-progress-prize/rloo.png)

åœ¨æ¨ç†æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿè¿›è¡Œäº†å¦‚ä¸‹å®éªŒï¼š

- ä½¿ç”¨é™æ€ KV ç¼“å­˜å’Œ torch ç¼–è¯‘ã€‚æˆ‘ä»¬å‘ç°æˆ‘ä»¬èƒ½å¤Ÿåœ¨ H100 ä¸Šå°†åŸç”Ÿ `transformers` ä»£ç çš„ç”Ÿæˆé€Ÿåº¦åŠ å¿« 2-3 å€ï¼Œä½†åœ¨ Kaggle T4 ä¸Šä¼šé‡åˆ°å„ç§ç¥ç§˜é”™è¯¯ï¼Œä¸»è¦æ˜¯ç”±äº `accelerate` ä¸­çš„ torch ç¼–è¯‘ç¼ºä¹å¯¹æ¨¡å‹åˆ†ç‰‡çš„æ”¯æŒã€‚

å„ç§æ¨¡å‹åˆå¹¶æŠ€æœ¯ï¼Œä¾‹å¦‚ [**DARE**](https://arxiv.org/abs/2311.03099)ã€[**TIES**](https://arxiv.org/abs/2306.01708) ä»¥åŠ [**WARP**](https://arxiv.org/abs/2406.16768v1)ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ [**mergekit**](https://github.com/arcee-ai/mergekit) æ¥åˆå¹¶ SFT å’Œ KTO æ¨¡å‹ï¼Œæˆ–è€…å°† SFT æ¨¡å‹ä¸å…¬å¼€çš„ `DeepSeekMath` æ¨¡å‹åˆå¹¶ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å‘ç°è¿™äº›åˆå¹¶å¯¼è‡´æˆ‘ä»¬çš„å†…éƒ¨è¯„ä¼°å‡ºç°é‡å¤§å€’é€€ï¼Œå¹¶ä¸”æˆ‘ä»¬æ²¡æœ‰æ—¶é—´å¯¹æ­¤è¿›è¡Œæ›´æ·±å…¥æ¢ç´¢ã€‚

## Numina çš„æœªæ¥ - å¯»æ±‚è´¡çŒ®è€…å’Œåˆä½œä¼™ä¼´ï¼

ç»§ Numina åˆæ­¥æˆåŠŸèµ¢å¾— AIMO 2024 è¿›æ­¥å¥–ä¹‹åï¼Œæˆ‘ä»¬çš„ç›®æ ‡å˜å¾—æ›´ä¸ºå®å¤§ï¼Œå³è‚©è´Ÿä¿ƒè¿›æ•°å­¦é¢†åŸŸäººå·¥æ™ºèƒ½å’Œäººç±»æ™ºèƒ½å‘å±•çš„ä½¿å‘½ã€‚ä½ å¯ä»¥è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ï¼Œäº†è§£æœ‰å…³æˆ‘ä»¬é¡¹ç›®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·éšæ—¶é€šè¿‡ [**contact@projectnumina.ai**](mailto:contact@projectnumina.ai) ç»™æˆ‘ä»¬ç•™è¨€ã€‚

Numina æ—¨åœ¨å‘ä¸–ç•Œå„åœ°æ„¿æ„é€šè¿‡äººå·¥æ™ºèƒ½è¿›ä¸€æ­¥æ¨åŠ¨æ•°å­¦å‘å±•çš„äººæ‰å’Œæ”¯æŒè€…å¼€æ”¾ï¼Œä¿æŒæ•°å­¦çš„å¼€æ”¾æœ¬è´¨ï¼

## è‡´è°¢

æˆ‘ä»¬æ„Ÿè°¢ Thomas Wolf å’Œ Leandro von Werra ä¿ƒæˆäº† Numina å’Œ Hugging Face çš„åˆä½œã€‚æˆ‘ä»¬è¿˜æ„Ÿè°¢ Hugo Larcher åœ¨æˆ‘ä»¬ä½¿ç”¨ Hugging Face GPU é›†ç¾¤çš„è¿‡ç¨‹ä¸­æä¾›çš„å¸®åŠ©ï¼ŒColin Raffel å¯¹æ¨¡å‹åˆå¹¶æ–¹æ³•çš„å»ºè®®ï¼Œä»¥åŠ Omar Sanseviero å¯¹åšæ–‡çš„åé¦ˆã€‚

æˆ‘ä»¬è¿˜æƒ³æ„Ÿè°¢ [**Mistral.ai**](https://mistral.ai)ã€[**General Catalyst**](https://www.generalcatalyst.com/)ã€[**Answer.AI**](https://answerai.pro) ä»¥åŠ[**åŒ—äº¬å¤§å­¦åŒ—äº¬å›½é™…æ•°å­¦ç ”ç©¶ä¸­å¿ƒ**](https://bicmr.pku.edu.cn/)è‡ªé¡¹ç›®ä¼Šå§‹çš„æ”¯æŒã€‚

æœ€åï¼Œæˆ‘ä»¬æ„Ÿè°¢ AIMO å›¢é˜Ÿå‘èµ·äº†å¦‚æ­¤ä»¤äººæ¿€åŠ¨ã€é¼“èˆäººå¿ƒçš„æ¯”èµ›ï¼

> è‹±æ–‡åŸæ–‡: <url> https://huggingface.co/blog/winning-aimo-progress-prize </url>
> åŸæ–‡ä½œè€…ï¼šYann Fleureauï¼ŒLi Jiaï¼ŒEdward Beechingï¼ŒLewis Tunstallï¼ŒBen Lipkinï¼ŒRoman Soletskyiï¼ŒShengyi Costa Huangï¼ŒKashif Rasul
> è¯‘è€…: Matrix Yao (å§šä¼Ÿå³°)ï¼Œè‹±ç‰¹å°”æ·±åº¦å­¦ä¹ å·¥ç¨‹å¸ˆï¼Œå·¥ä½œæ–¹å‘ä¸º transformer-family æ¨¡å‹åœ¨å„æ¨¡æ€æ•°æ®ä¸Šçš„åº”ç”¨åŠå¤§è§„æ¨¡æ¨¡å‹çš„è®­ç»ƒæ¨ç†ã€‚