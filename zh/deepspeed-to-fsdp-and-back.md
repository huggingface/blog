---
title: "ä» DeepSpeed åˆ° FSDPï¼Œå†å›åˆ° Hugging Face Accelerate"
thumbnail: /blog/assets/deepspeed-to-fsdp-and-back/thumbnail.png
authors:
- user: mirinflim
  guest: true
  org: IBM
- user: aldopareja
  guest: true
  org: IBM
- user: muellerzr
- user: stas
  guest: true
  org: ContextualAI
translators:
- user: MatrixYao
---

# Hugging Face Accelerate ä¸¤ä¸ªåç«¯çš„æ•…äº‹ï¼šFSDP ä¸ DeepSpeed

ç¤¾åŒºä¸­æœ‰ä¸¤ä¸ªæµè¡Œçš„[é›¶å†—ä½™ä¼˜åŒ–å™¨ï¼ˆZero Redundancy Optimizerï¼ŒZeROï¼‰](https://arxiv.org/abs/1910.02054)ç®—æ³•å®ç°ï¼Œä¸€ä¸ªæ¥è‡ª [DeepSpeed](https://github.com/microsoft/DeepSpeed)ï¼Œå¦ä¸€ä¸ªæ¥è‡ª [PyTorch](https://pytorch.org/docs/stable/fsdp.html)ã€‚Hugging Face [Accelerate](https://huggingface.co/docs/accelerate/en/index) å¯¹è¿™ä¸¤è€…éƒ½è¿›è¡Œäº†é›†æˆå¹¶é€šè¿‡æ¥å£æš´éœ²å‡ºæ¥ï¼Œä»¥ä¾›æœ€ç»ˆç”¨æˆ·åœ¨è®­ç»ƒ/å¾®è°ƒæ¨¡å‹æ—¶è‡ªä¸»é€‰æ‹©å…¶ä¸­ä¹‹ä¸€ã€‚æœ¬æ–‡é‡ç‚¹ä»‹ç»äº† Accelerate å¯¹å¤–æš´éœ²çš„è¿™ä¸¤ä¸ªåç«¯ä¹‹é—´çš„å·®å¼‚ã€‚ä¸ºäº†è®©ç”¨æˆ·èƒ½å¤Ÿåœ¨è¿™ä¸¤ä¸ªåç«¯ä¹‹é—´æ— ç¼åˆ‡æ¢ï¼Œæˆ‘ä»¬åœ¨ Accelerate ä¸­åˆå¹¶äº†[ä¸€ä¸ªç²¾åº¦ç›¸å…³çš„ PR](https://github.com/huggingface/accelerate/issues/2624) åŠ[ä¸€ä¸ªæ–°çš„æ¦‚å¿µæŒ‡å—](https://huggingface.co/docs/accelerate/concept_guides/fsdp_and_deepspeed)ã€‚

## FSDP å’Œ DeepSpeed å¯ä»¥äº’æ¢å—ï¼Ÿ

æœ€è¿‘ï¼Œæˆ‘ä»¬å°è¯•åˆ†åˆ«ä½¿ç”¨ DeepSpeed å’Œ PyTorch FSDP è¿›è¡Œè®­ç»ƒï¼Œå‘ç°ä¸¤è€…è¡¨ç°æœ‰æ‰€ä¸åŒã€‚æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Mistral-7B åŸºç¡€æ¨¡å‹ï¼Œå¹¶ä»¥åŠç²¾åº¦ï¼ˆ`bfloat16`ï¼‰åŠ è½½ã€‚å¯ä»¥çœ‹åˆ° DeepSpeedï¼ˆè“è‰²ï¼‰æŸå¤±å‡½æ•°æ”¶æ•›è‰¯å¥½ï¼Œä½† FSDPï¼ˆæ©™è‰²ï¼‰æŸå¤±å‡½æ•°æ²¡æœ‰æ”¶æ•›ï¼Œå¦‚å›¾ 1 æ‰€ç¤ºã€‚

![å›¾ 1](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/deepspeed-to-fsdp-and-back/figure_1.png)

æˆ‘ä»¬çŒœæƒ³å¯èƒ½éœ€è¦æ ¹æ® GPU æ•°é‡å¯¹å­¦ä¹ ç‡è¿›è¡Œç¼©æ”¾ï¼Œä¸”ç”±äºæˆ‘ä»¬ä½¿ç”¨äº† 4 ä¸ª GPUï¼Œäºæ˜¯æˆ‘ä»¬å°†å­¦ä¹ ç‡æé«˜äº† 4 å€ã€‚ç„¶åï¼ŒæŸå¤±è¡¨ç°å¦‚å›¾ 2 æ‰€ç¤ºã€‚

![å›¾ 2](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/deepspeed-to-fsdp-and-back/figure_2.png)

çœ‹èµ·æ¥ï¼Œé€šè¿‡æŒ‰ GPU æ•°é‡ç¼©æ”¾ FSDP å­¦ä¹ ç‡ï¼Œå·²ç»è¾¾åˆ°äº†é¢„æœŸï¼ç„¶è€Œï¼Œå½“æˆ‘ä»¬åœ¨ä¸è¿›è¡Œç¼©æ”¾çš„æƒ…å†µä¸‹å°è¯•å…¶ä»–å­¦ä¹ ç‡ï¼ˆ`1e-5`ï¼‰æ—¶ï¼Œæˆ‘ä»¬å´åˆè§‚å¯Ÿåˆ°è¿™ä¸¤ä¸ªæ¡†æ¶çš„æŸå¤±å’Œæ¢¯åº¦èŒƒæ•°ç‰¹å¾åˆæ˜¯è¶‹è¿‘ä¸€è‡´çš„ï¼Œå¦‚å›¾ 3 æ‰€ç¤ºã€‚

![å›¾ 3](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/deepspeed-to-fsdp-and-back/figure_3.png)

## ç²¾åº¦å¾ˆé‡è¦

åœ¨ `DeepSpeed` ä»£ç åº“çš„
`DeepSpeedZeroOptimizer_Stage3`ï¼ˆé¡¾åæ€ä¹‰ï¼Œå¤„ç†ç¬¬ 3 é˜¶æ®µä¼˜åŒ–å™¨åˆ†ç‰‡ï¼‰å®ç°ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ° `trainable_param_groups`ï¼ˆå¯è®­å‚æ•°ç»„ï¼‰è¢«ä¼ å…¥ä¸€ä¸ªå†…éƒ¨å‡½æ•° `_setup_for_real_optimizer`ï¼Œè¯¥å‡½æ•°ä¼šè°ƒç”¨å¦ä¸€ä¸ªåä¸º `_create_fp32_partitions` çš„å‡½æ•°ã€‚æ­£å¦‚å…¶åç§°ä¸­çš„ `fp32` æ‰€ç¤ºï¼Œ`DeepSpeed` å†…éƒ¨æ‰§è¡Œäº†ç²¾åº¦ä¸Šè½¬ï¼Œå¹¶åœ¨è®¾è®¡ä¸Šå§‹ç»ˆå°†ä¸»æƒé‡ä¿æŒä¸º `fp32` ç²¾åº¦ã€‚è€Œä¸Šè½¬è‡³å…¨ç²¾åº¦æ„å‘³ç€ï¼šåŒä¸€ä¸ªå­¦ä¹ ç‡ï¼Œä¸Šè½¬åçš„ä¼˜åŒ–å™¨å¯ä»¥æ”¶æ•›ï¼Œè€ŒåŸå§‹ä½ç²¾åº¦ä¸‹çš„ä¼˜åŒ–å™¨åˆ™å¯èƒ½ä¸ä¼šæ”¶æ•›ã€‚å‰è¿°ç°è±¡å°±æ˜¯è¿™ç§ç²¾åº¦å·®å¼‚çš„äº§ç‰©ã€‚

åœ¨ FSDP ä¸­ï¼Œåœ¨æŠŠæ¨¡å‹å’Œä¼˜åŒ–å™¨å‚æ•°åˆ†ç‰‡åˆ°å„ GPU ä¸Šä¹‹å‰ï¼Œè¿™äº›å‚æ•°é¦–å…ˆä¼šè¢«â€œå±•å¹³â€ä¸ºä¸€ç»´å¼ é‡ã€‚FSDP å’Œ DeepSpeed å¯¹è¿™äº›â€œå±•å¹³â€å‚æ•°ä½¿ç”¨äº†ä¸åŒçš„ `dtype`ï¼Œè¿™ä¼šå½±å“ PyTorch ä¼˜åŒ–å™¨çš„è¡¨ç°ã€‚è¡¨ 1 æ¦‚è¿°äº†ä¸¤ä¸ªæ¡†æ¶å„è‡ªçš„å¤„ç†æµç¨‹ï¼Œâ€œæœ¬åœ°ï¼Ÿâ€åˆ—è¯´æ˜äº†å½“å‰æ­¥éª¤æ˜¯å¦æ˜¯ç”±å„ GPU æœ¬åœ°æ‰§è¡Œçš„ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œé‚£ä¹ˆä¸Šè½¬çš„å†…å­˜å¼€é”€å°±å¯ä»¥åˆ†æ‘Šåˆ°å„ä¸ª GPUã€‚

| **æµç¨‹**                                                                              | **æœ¬åœ°ï¼Ÿ** | **æ¡†æ¶**     | **è¯¦æƒ…**                                                                                                                                                                |
| ---------------------------------------------------------------------------------------- | ---------- | ----------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| æ¨¡å‹åŠ è½½ï¼ˆå¦‚ `AutoModel.from_pretrained(..., torch_dtype=torch_dtype)`ï¼‰ | âŒ         |                   |                                                                                                                                                                            |
| å‡†å¤‡ï¼Œå¦‚åˆ›å»ºâ€œå±•å¹³å‚æ•°â€                            | âœ…         | FSDP<br>DeepSpeed | ä½¿ç”¨ `torch_dtype`<br>ä¸ç®¡ `torch_dtype`ï¼Œç›´æ¥åˆ›å»ºä¸º `float32`                                                                                             |
| ä¼˜åŒ–å™¨åˆå§‹åŒ–                                                                 | âœ…         | FSDP<br>DeepSpeed | ç”¨ `torch_dtype` åˆ›å»ºå‚æ•°<br>ç”¨ `float32` åˆ›å»ºå‚æ•°                                                                                                    |
| è®­ç»ƒæ­¥ï¼ˆå‰å‘ã€åå‘ã€å½’çº¦ï¼‰                            | âŒ         | FSDP<br>DeepSpeed | éµå¾ª [fsdp.MixedPrecision](https://pytorch.org/docs/stable/fsdp.html#torch.distributed.fsdp.MixedPrecision)<br>éµå¾ª `deepspeed_config_file` ä¸­çš„æ··åˆç²¾åº¦è®¾ç½® |
| ä¼˜åŒ–å™¨ï¼ˆå‡†å¤‡é˜¶æ®µï¼‰                                                                     | âœ…         | FSDP<br>DeepSpeed | æŒ‰éœ€ä¸Šè½¬è‡³ `torch_dtype`<br>æ‰€æœ‰å‡ä¸Šè½¬è‡³ `float32`                                                                                                   |
| ä¼˜åŒ–å™¨ï¼ˆå®é™…æ‰§è¡Œé˜¶æ®µï¼‰                                                                 | âœ…         | FSDP<br>DeepSpeed | ä»¥ `torch_dtype` ç²¾åº¦è¿›è¡Œ<br>ä»¥ `float32` ç²¾åº¦è¿›è¡Œ                                                                                                                             |
> è¡¨ 1ï¼š FSDP ä¸ DeepSpeed æ··åˆç²¾åº¦å¤„ç†å¼‚åŒ

å‡ ä¸ªè¦ç‚¹ï¼š
* æ­£å¦‚ ğŸ¤— Accelerate ä¸Šçš„[è¿™ä¸€é—®é¢˜](https://github.com/huggingface/accelerate/issues/2624#issuecomment-2058402753)æ‰€è¿°ï¼Œæ··åˆç²¾åº¦è®­ç»ƒçš„ç»éªŒæ³•åˆ™æ˜¯å°†å¯è®­å‚æ•°ç²¾åº¦ä¿æŒä¸º `float32`ã€‚ 
* å½“åœ¨å¤§é‡ GPU ä¸Šè¿›è¡Œåˆ†ç‰‡æ—¶ï¼Œä¸Šè½¬ï¼ˆå¦‚ `DeepSpeed` ä¸­æ‰€åšçš„é‚£æ ·ï¼‰å¯¹å†…å­˜æ¶ˆè€—çš„å½±å“å¯èƒ½å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ç„¶è€Œï¼Œå½“åœ¨å°‘é‡ GPU ä¸Šä½¿ç”¨ `DeepSpeed` æ—¶ï¼Œå†…å­˜æ¶ˆè€—ä¼šæ˜¾è‘—å¢åŠ ï¼Œé«˜è¾¾ 2 å€ã€‚
* FSDP çš„ PyTorch åŸç”Ÿå®ç°ä¸ä¼šå¼ºåˆ¶ä¸Šè½¬ï¼Œå…¶æ”¯æŒç”¨æˆ·ä»¥ä½ç²¾åº¦æ“ä½œ PyTorch ä¼˜åŒ–å™¨ï¼Œå› æ­¤ç›¸æ¯” `DeepSpeed` æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚

## åœ¨ ğŸ¤— Accelerate ä¸­å¯¹é½ DeepSpeed å’Œ FSDP çš„è¡Œä¸º

ä¸ºäº†åœ¨ğŸ¤— Accelerate ä¸­æ›´å¥½åœ°å¯¹é½ DeepSpeed å’Œ FSDP çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯ç”¨æ··åˆç²¾åº¦æ—¶è‡ªåŠ¨å¯¹ FSDP æ‰§è¡Œä¸Šè½¬ã€‚æˆ‘ä»¬ä¸ºæ­¤åšäº†ä¸€ä¸ª PRï¼Œè¯¥ PR ç°å·²åŒ…å«åœ¨ [0.30.0 ç‰ˆæœ¬](https://github.com/huggingface/accelerate/releases/tag/v0.30.0)ä¸­äº†ã€‚

![å›¾ 4](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/blog/deepspeed-to-fsdp-and-back/figure_4.png)

æœ‰äº†è¿™ä¸ª PRï¼ŒFSDP å°±èƒ½ä»¥ä¸¤ç§æ¨¡å¼è¿è¡Œï¼š
- ä¸ DeepSpeed ä¸€è‡´çš„`æ··åˆç²¾åº¦`æ¨¡å¼
- é’ˆå¯¹å†…å­˜å—é™åœºæ™¯çš„ä½ç²¾åº¦æ¨¡å¼ï¼Œå¦‚å›¾ 4 æ‰€ç¤ºã€‚

è¡¨ 2 æ€»ç»“äº†ä¸¤ç§æ–°çš„ FSDP æ¨¡å¼ï¼Œå¹¶ä¸ DeepSpeed è¿›è¡Œäº†æ¯”è¾ƒã€‚
| **æ¡†æ¶**             | **æ¨¡å‹åŠ è½½ (`torch_dtype`)** | **æ··åˆç²¾åº¦** | **å‡†å¤‡ï¼ˆæœ¬åœ°ï¼‰** | **è®­ç»ƒ** | **ä¼˜åŒ–å™¨ï¼ˆæœ¬åœ°ï¼‰** |
| ------------------------- | --------------------------------- | ------------------- | ----------------------- | ------------ | --------------------- |
| FSDPï¼ˆä½ç²¾åº¦æ¨¡å¼ï¼‰ | `bf16`                            | ç¼ºçœï¼ˆæ— ï¼‰    | `bf16`                  | `bf16`       | `bf16`                |
| FSDPï¼ˆæ··åˆç²¾åº¦æ¨¡å¼ï¼‰      | `bf16`                            | `bf16`              | `fp32`                  | `bf16`       | `fp32`                |
| DeepSpeed                 | `bf16`                            | `bf16`              | `fp32`                  | `bf16`       | `fp32`                |

> è¡¨ 2ï¼šä¸¤ç§æ–° FSDP æ¨¡å¼æ€»ç»“åŠä¸ DeepSpeed çš„å¯¹æ¯”

## ååé‡æµ‹è¯•ç»“æœ

æˆ‘ä»¬ä½¿ç”¨ [IBM Granite 7B](https://huggingface.co/ibm-granite/granite-7b-base) æ¨¡å‹ï¼ˆå…¶æ¶æ„ä¸º Meta Llama2ï¼‰è¿›è¡Œååé‡æ¯”è¾ƒã€‚æˆ‘ä»¬æ¯”è¾ƒäº†æ¨¡å‹çš„æµ®ç‚¹ç®—åŠ›åˆ©ç”¨ç‡ (Model Flops Utilizationï¼ŒMFU) å’Œæ¯ GPU æ¯ç§’è¯å…ƒæ•°è¿™ä¸¤ä¸ªæŒ‡æ ‡ï¼Œå¹¶é’ˆå¯¹ FSDPï¼ˆå®Œå…¨åˆ†ç‰‡ï¼‰å’Œ DeepSpeedï¼ˆZeRO3ï¼‰ä¸¤ä¸ªåœºæ™¯è¿›è¡Œäº†æµ‹é‡ã€‚ 

å¦‚ä¸Šæ–‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ 4 å¼  A100 GPUï¼Œè¶…å‚å¦‚ä¸‹ï¼š
- batch size ä¸º 8
- æ¨¡å‹åŠ è½½ä¸º `torch.bfloat16`
- ä½¿ç”¨ `torch.bfloat16` æ··åˆç²¾åº¦ 

è¡¨ 3 è¡¨æ˜ FSDP å’Œ DeepSpeed çš„è¡¨ç°ç±»ä¼¼ï¼Œè¿™ä¸æˆ‘ä»¬çš„é¢„æœŸç›¸ç¬¦ã€‚

> éšç€å¤§è§„æ¨¡å¯¹é½æŠ€æœ¯ï¼ˆå¦‚ [InstructLab](https://github.com/instructlab) åŠ [GLAN](https://arxiv.org/abs/2402.13064)ï¼‰çš„æµè¡Œï¼Œæˆ‘ä»¬è®¡åˆ’å¯¹ç»“åˆå„ç§æé«˜ååé‡çš„æ–¹æ³•ï¼ˆå¦‚ï¼Œåºåˆ—ç»„è£… + 4D æ©ç ã€torch.compileã€é€‰æ‹©æ€§ checkpointingï¼‰è¿›è¡Œå…¨é¢çš„ååé‡å¯¹æ¯”åŸºå‡†æµ‹è¯•ã€‚

| **æ¡†æ¶**       | **æ¯ GPU æ¯ç§’è¯å…ƒæ•°** | **æ¯æ­¥è€—æ—¶ï¼ˆsï¼‰** | **æµ®ç‚¹ç®—åŠ›åˆ©ç”¨ç‡ï¼ˆMFUï¼‰** |
| ------------------- | ------------------------- | ----------------- | --------------------------------- |
| FSDPï¼ˆæ··åˆç²¾åº¦æ¨¡å¼ï¼‰| 3158.7                    | 10.4              | 0.41                              |
| DeepSpeed           | 3094.5                    | 10.6              | 0.40                              |

> è¡¨ 3ï¼šå››å¼  A100 GPU ä¸Š FSDP å’Œ DeepSpeed ä¹‹é—´çš„å¤§è‡´ååé‡æ¯”è¾ƒã€‚

## æœ€åçš„è¯

æˆ‘ä»¬æä¾›äº†æ–°çš„[æ¦‚å¿µæŒ‡å—](https://huggingface.co/docs/accelerate/v0.31.0/en/concept_guides/fsdp_and_deepspeed)ä»¥å¸®åŠ©ç”¨æˆ·åœ¨ä¸¤ä¸ªæ¡†æ¶ä¹‹é—´è¿ç§»ã€‚è¯¥æŒ‡å—å¯ä»¥å¸®åŠ©ç”¨æˆ·å˜æ¸…ä»¥ä¸‹é—®é¢˜ï¼š
* å¦‚ä½•å®ç°ç­‰æ•ˆçš„åˆ†ç‰‡ç­–ç•¥ï¼Ÿ
* å¦‚ä½•è¿›è¡Œé«˜æ•ˆçš„æ¨¡å‹åŠ è½½ï¼Ÿ
* FSDP å’Œ DeepSpeed ä¸­å¦‚ä½•ç®¡ç†æƒé‡é¢„å–ï¼Ÿ
* ä¸ DeepSpeed å¯¹ç­‰çš„ FSDP å°è£…æ˜¯ä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬åœ¨ ğŸ¤— Accelerate ä¸­è€ƒè™‘äº†é…ç½®è¿™äº›æ¡†æ¶çš„å„ç§æ–¹å¼:
- ä½¿ç”¨ `accelerate launch` ä»å‘½ä»¤è¡Œé…ç½®
- ä»ğŸ¤— Accelerate æä¾›ç»™ [`DeepSpeed`](https://huggingface.co/docs/accelerate/main/en/package_reference/deepspeed) å’Œ [`FSDP`](https://huggingface.co/docs/accelerate/main/en/package_reference/fsdp) çš„å„ç§ `Plugin` ç±»ä¸­é…ç½®

ğŸ¤— Accelerate ä½¿å¾—åœ¨ FSDP å’Œ DeepSpeed ä¹‹é—´åˆ‡æ¢éå¸¸**ä¸æ»‘**ï¼Œå¤§éƒ¨åˆ†å·¥ä½œéƒ½åªæ¶‰åŠæ›´æ”¹ Accelerate é…ç½®æ–‡ä»¶ï¼ˆæœ‰å…³è¿™æ–¹é¢çš„è¯´æ˜ï¼Œè¯·å‚é˜…æ–°çš„æ¦‚å¿µæŒ‡å—ï¼‰ã€‚

é™¤äº†é…ç½®å˜æ›´ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¦‚æ£€æŸ¥ç‚¹å¤„ç†æ–¹å¼çš„å·®å¼‚ç­‰ï¼Œæˆ‘ä»¬ä¸€å¹¶åœ¨æŒ‡å—ä¸­è¿›è¡Œäº†è¯´æ˜ã€‚

æœ¬æ–‡ä¸­çš„æ‰€æœ‰å®éªŒéƒ½å¯ä»¥ä½¿ç”¨[åŸå§‹ ğŸ¤— Accelerate é—®é¢˜](https://github.com/huggingface/accelerate/issues/2624)ä¸­çš„ä»£ç é‡ç°ã€‚

æˆ‘ä»¬è®¡åˆ’åç»­åœ¨æ›´å¤§è§„æ¨¡ GPU ä¸Šè¿›è¡Œååé‡æ¯”è¾ƒï¼Œå¹¶å¯¹å„ç§ä¸åŒæŠ€æœ¯è¿›è¡Œæ¯”è¾ƒï¼Œä»¥åœ¨ä¿æŒæ¨¡å‹è´¨é‡çš„å‰æä¸‹æ›´å¥½åœ°åˆ©ç”¨æ›´å¤šçš„ GPU è¿›è¡Œå¾®è°ƒå’Œå¯¹é½ã€‚

## è‡´è°¢

æœ¬å·¥ä½œå‡èšäº†æ¥è‡ªå¤šä¸ªç»„ç»‡çš„å¤šä¸ªå›¢é˜Ÿçš„å…±åŒåŠªåŠ›ã€‚å§‹äº IBM ç ”ç©¶ä¸­å¿ƒï¼Œç‰¹åˆ«æ˜¯å‘ç°è¯¥é—®é¢˜çš„ Aldo Pareja å’Œå‘ç°ç²¾åº¦å·®è·å¹¶è§£å†³è¯¥é—®é¢˜çš„ Fabian Limã€‚Zach Mueller å’Œ [Stas Bekman](https://github.com/stas00) åœ¨æä¾›åé¦ˆå’Œä¿®å¤ accelerate çš„é—®é¢˜ä¸Šè¡¨ç°å‡ºè‰²ã€‚Meta PyTorch å›¢é˜Ÿçš„ Less Wright å¯¹æœ‰å…³ FSDP å‚æ•°çš„é—®é¢˜éå¸¸æœ‰å¸®åŠ©ã€‚æœ€åï¼Œæˆ‘ä»¬è¿˜è¦æ„Ÿè°¢ [DeepSpeed](https://www.deepspeed.ai/) å›¢é˜Ÿå¯¹æœ¬æ–‡æä¾›çš„åé¦ˆã€‚

> è‹±æ–‡åŸæ–‡: <url> https://huggingface.co/blog/deepspeed-to-fsdp-and-back </url>
> åŸæ–‡ä½œè€…ï¼šYu Chin Fabianï¼ŒAldo Parejaï¼ŒZachary Muellerï¼ŒStas Bekman
> è¯‘è€…: Matrix Yao (å§šä¼Ÿå³°)ï¼Œè‹±ç‰¹å°”æ·±åº¦å­¦ä¹ å·¥ç¨‹å¸ˆï¼Œå·¥ä½œæ–¹å‘ä¸º transformer-family æ¨¡å‹åœ¨å„æ¨¡æ€æ•°æ®ä¸Šçš„åº”ç”¨åŠå¤§è§„æ¨¡æ¨¡å‹çš„è®­ç»ƒæ¨ç†ã€‚